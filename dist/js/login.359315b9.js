(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["login"],{"0418":function(e,t,a){"use strict";var n=a("7a23"),r=Object(n["N"])("data-v-81df7ef0");Object(n["A"])("data-v-81df7ef0");var i=Object(n["i"])("div",{class:"block"},null,-1),o=Object(n["i"])("i",{class:"iconfont more"},null,-1);Object(n["y"])();var l=r((function(e,t,a,l,c,u){var s=Object(n["E"])("van-nav-bar");return Object(n["x"])(),Object(n["f"])(n["a"],null,[i,Object(n["i"])(s,{class:"header",onClickLeft:l.back,title:a.title,"left-text":"返回","left-arrow":""},{right:r((function(){return[o]})),_:1},8,["onClickLeft","title"])],64)})),c=a("6c02"),u={name:"Header",props:{title:{type:String,default:""}},setup:function(){var e=Object(c["d"])(),t=function(){e.back()};return{back:t}}};a("a25b");u.render=l,u.__scopeId="data-v-81df7ef0";t["a"]=u},3874:function(e,t,a){"use strict";a("aa0f")},5527:function(e,t,a){},"6cfb":function(e,t,a){"use strict";a("5527")},"81d5":function(e,t,a){"use strict";var n=a("7b0b"),r=a("23cb"),i=a("50c4");e.exports=function(e){var t=n(this),a=i(t.length),o=arguments.length,l=r(o>1?arguments[1]:void 0,a),c=o>2?arguments[2]:void 0,u=void 0===c?a:r(c,a);while(u>l)t[l++]=e;return t}},a25b:function(e,t,a){"use strict";a("f376")},a55b:function(e,t,a){"use strict";a.r(t);var n=a("7a23"),r=a("cf05"),i=a.n(r),o=Object(n["N"])("data-v-78e5145e");Object(n["A"])("data-v-78e5145e");var l={class:"auth"},c=Object(n["i"])("img",{class:"logo",src:i.a,alt:""},null,-1),u={class:"form"},s={style:{margin:"16px 0"}},d=Object(n["h"])(" 登录 "),f={class:"form"},b={style:{margin:"16px 0"}},p=Object(n["h"])(" 注册 ");Object(n["y"])();var m=o((function(e,t,a,r,i,m){var g=Object(n["E"])("Header"),v=Object(n["E"])("van-field"),h=Object(n["E"])("van-button"),O=Object(n["E"])("van-form"),j=Object(n["E"])("VueImgVerify");return Object(n["x"])(),Object(n["f"])(n["a"],null,[Object(n["i"])(g,{title:"login"==e.type?"登录":"注册"},null,8,["title"]),Object(n["i"])("div",l,[c,"login"==e.type?(Object(n["x"])(),Object(n["f"])(O,{key:0,class:"form-wrap",onSubmit:r.onSubmit},{default:o((function(){return[Object(n["i"])("div",u,[Object(n["i"])(v,{clearable:"",modelValue:e.username,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.username=t}),name:"username",label:"账号",placeholder:"请输入账号",rules:[{required:!0,message:"请填写账户"}]},null,8,["modelValue"]),Object(n["i"])(v,{clearable:"",modelValue:e.password,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.password=t}),type:"password",name:"password",label:"密码",placeholder:"请输入密码",rules:[{required:!0,message:"请填写密码"}]},null,8,["modelValue"])]),Object(n["i"])("div",s,[Object(n["i"])(h,{round:"",block:"",type:"primary","native-type":"submit"},{default:o((function(){return[d]})),_:1}),Object(n["i"])("p",{onClick:t[3]||(t[3]=function(e){return r.chanegType("register")}),class:"change-btn"},"没有账号，前往注册")])]})),_:1},8,["onSubmit"])):Object(n["g"])("",!0),"register"==e.type?(Object(n["x"])(),Object(n["f"])(O,{key:1,class:"form-wrap",onSubmit:r.onSubmit},{default:o((function(){return[Object(n["i"])("div",f,[Object(n["i"])(v,{clearable:"",modelValue:e.username,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.username=t}),name:"username",label:"账号",placeholder:"请输入账号",rules:[{required:!0,message:"请填写账号"}]},null,8,["modelValue"]),Object(n["i"])(v,{clearable:"",modelValue:e.password,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.password=t}),type:"password",name:"password",label:"密码",placeholder:"请输入密码",rules:[{required:!0,message:"请填写密码"}]},null,8,["modelValue"]),Object(n["i"])(v,{center:"",clearable:"",label:"验证码",placeholder:"输入验证码",modelValue:e.verify,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.verify=t})},{button:o((function(){return[Object(n["i"])(j,{ref:"verifyRef"},null,512)]})),_:1},8,["modelValue"])]),Object(n["i"])("div",b,[Object(n["i"])(h,{round:"",block:"",loading:e.loading,type:"primary","native-type":"submit"},{default:o((function(){return[p]})),_:1},8,["loading"]),Object(n["i"])("p",{onClick:t[7]||(t[7]=function(e){return r.chanegType("login")}),class:"change-btn"},"登录已有账号")])]})),_:1},8,["onSubmit"])):Object(n["g"])("",!0)])],64)})),g=a("5530"),v=(a("433b"),a("d399")),h=(a("96cf"),a("1da1")),O={class:"img-verify"};function j(e,t,a,r,i,o){return Object(n["x"])(),Object(n["f"])("div",O,[Object(n["i"])("canvas",{ref:"verify",width:e.width,height:e.height,onClick:t[1]||(t[1]=function(){return r.handleDraw&&r.handleDraw.apply(r,arguments)})},null,8,["width","height"])])}a("99af"),a("cb29");var y={setup:function(){var e=Object(n["C"])(null),t=Object(n["B"])({pool:"ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",width:120,height:40,imgCode:""});Object(n["u"])((function(){t.imgCode=o()}));var a=function(){t.imgCode=o()},r=function(e,t){return parseInt(Math.random()*(t-e)+e)},i=function(e,t){var a=r(e,t),n=r(e,t),i=r(e,t);return"rgb(".concat(a,",").concat(n,",").concat(i,")")},o=function(){var a=e.value.getContext("2d");a.fillStyle=i(180,230),a.fillRect(0,0,t.width,t.height);for(var n="",o=0;o<4;o++){var l=t.pool[r(0,t.pool.length)];n+=l;var c=r(18,40),u=r(-30,30);a.font=c+"px Simhei",a.textBaseline="top",a.fillStyle=i(80,150),a.save(),a.translate(30*o+15,15),a.rotate(u*Math.PI/180),a.fillText(l,-10,-15),a.restore()}for(var s=0;s<5;s++)a.beginPath(),a.moveTo(r(0,t.width),r(0,t.height)),a.lineTo(r(0,t.width),r(0,t.height)),a.strokeStyle=i(180,230),a.closePath(),a.stroke();for(var d=0;d<40;d++)a.beginPath(),a.arc(r(0,t.width),r(0,t.height),1,0,2*Math.PI),a.closePath(),a.fillStyle=i(150,200),a.fill();return n};return Object(g["a"])(Object(g["a"])({},Object(n["H"])(t)),{},{verify:e,handleDraw:a})}};a("3874");y.render=j;var w=y,k=a("0418"),x=a("a27e"),C=(a("a18c"),{name:"Login",components:{VueImgVerify:w,Header:k["a"]},setup:function(){var e=Object(n["C"])(null),t=Object(n["B"])({username:"",password:"",type:"login",verify:"",imgCode:"",loading:!1}),a=function(){var a=Object(h["a"])(regeneratorRuntime.mark((function a(n){var r,i,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,"login"!=t.type){a.next=10;break}return a.next=4,x["a"].post("/user/login",{username:t.username,password:t.password});case 4:r=a.sent,i=r.data,localStorage.setItem("token",i.token),window.location.href="/",a.next=23;break;case 10:if(t.imgCode=e.value.imgCode||"",e.value.imgCode.toLowerCase()==t.verify.toLowerCase()){a.next=15;break}return console.log("verifyRef.value.imgCode",e.value.imgCode),v["a"].fail("验证码错误"),a.abrupt("return");case 15:return t.loading=!0,a.next=18,x["a"].post("/user/register",{username:t.username,password:t.password});case 18:o=a.sent,o.data,v["a"].success("注册成功"),t.type="login",t.loading=!1;case 23:a.next=29;break;case 25:a.prev=25,a.t0=a["catch"](0),console.log(111),t.loading=!1;case 29:case"end":return a.stop()}}),a,null,[[0,25]])})));return function(e){return a.apply(this,arguments)}}(),r=function(e){t.type=e};return Object(g["a"])(Object(g["a"])({},Object(n["H"])(t)),{},{onSubmit:a,chanegType:r,verifyRef:e})}});a("6cfb");C.render=m,C.__scopeId="data-v-78e5145e";t["default"]=C},aa0f:function(e,t,a){},cb29:function(e,t,a){var n=a("23e7"),r=a("81d5"),i=a("44d2");n({target:"Array",proto:!0},{fill:r}),i("fill")},cf05:function(e,t,a){e.exports=a.p+"img/logo.c37d8d38.png"},f376:function(e,t,a){}}]);